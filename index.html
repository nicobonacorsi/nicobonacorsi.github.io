<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nicolò Bonacorsi — Applied Mathematics</title>
  <meta name="description" content="Nicolò Bonacorsi — MS Applied Mathematics @ Columbia. Probability • Dynamical Systems • AI." />
  <meta name="theme-color" content="#0b0f14" />
  <meta property="og:title" content="Nicolò Bonacorsi — Applied Mathematics" />
  <meta property="og:description" content="Probability • Stochastic Systems • AI." />
  <meta property="og:type" content="website" />

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">

  <style>
    /* =====================================
       THEME — Dark Neon (default dark)
       ===================================== */
    :root {
      --bg: #0b0f14;            /* deep space */
      --bg-soft: #0e141b;       /* softer panel backdrop */
      --bg-accent: radial-gradient(1000px 600px at 85% -10%, #0b1a2a55, transparent 60%),
                   radial-gradient(800px 500px at 10% 110%, #1a0f2a55, transparent 60%);
      --card: #11161d;          /* card surface */
      --card-2: #0f141a;        /* subtle contrast */
      --text: #e9eef6;          /* primary text */
      --muted: #a7b1bf;         /* secondary text */
      --line: 1px solid rgba(255,255,255,0.06);
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 18px;
      --maxw: 1120px;
      --ease: cubic-bezier(.2,.8,.2,1);
      /* Accent duo (cyanish + violet) */
      --accent: #7dd3fc;        /* sky-300 */
      --accent-2: #a78bfa;      /* violet-400 */
      --accent-mix-1: color-mix(in oklab, var(--accent) 22%, #ffffff00);
      --accent-mix-2: color-mix(in oklab, var(--accent-2) 22%, #ffffff00);
      /* Reveal tuning */
      --reveal-duration: .75s;
      --reveal-distance: 14px;
      --reveal-blur: 4px;
      --reveal-ease: cubic-bezier(.2,.8,.2,1);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: var(--bg);
      background-image: 
        linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.0) 40%),
        var(--bg-accent);
      line-height: 1.6;
      letter-spacing: .2px;
      scroll-behavior: smooth;
    }
    h1,h2,h3,h4 { font-family: "Space Grotesk", Inter, sans-serif; letter-spacing: .3px; }
    h2 { font-size: clamp(1.9rem, 2.6vw + 1rem, 2.8rem); margin: 0 0 .6rem; }
    p { margin: 0 0 1rem; color: var(--muted); }
    a { color: var(--accent); text-decoration: none; transition: color .2s var(--ease); }
    a:hover { color: var(--accent-2); }
    .container { max-width: var(--maxw); margin: 0 auto; padding: 0 20px; }

    /* =====================
       NAVBAR
       ===================== */
    .nav { position: sticky; top: 0; z-index: 60; backdrop-filter: saturate(1.1) blur(8px); background: rgba(10,14,20,.45); border-bottom: var(--line); }
    .nav__inner { display: flex; align-items: center; justify-content: flex-end; padding: 14px 0; }
    .brand { display: flex; align-items: baseline; gap: 10px; }
    .brand__title { font-size: 1.1rem; font-weight: 700; color: var(--text); }
    .brand__tag { color: var(--muted); font-size: .95rem; }
    .nav__links { display: flex; gap: 18px; align-items: center; margin-left: auto; }
    .nav__links a { color: var(--text); opacity: .88; font-weight: 500; }
    .nav__links a:hover { opacity: 1; color: var(--accent); }
    .theme-btn { border: 0; background: var(--card); color: var(--text); padding: 8px 12px; border-radius: 999px; box-shadow: var(--shadow); cursor: pointer; transition: transform .2s var(--ease), background .3s var(--ease); border: var(--line); }
    .theme-btn:hover { transform: translateY(-1px); }

    /* =====================
       HERO
       ===================== */
    .hero { padding: 110px 0 70px; }
    .hero__grid { display: grid; grid-template-columns: 1.1fr .9fr; gap: 26px; align-items: center; }
    @media (max-width: 900px){ .hero__grid { grid-template-columns: 1fr; } }

    .hero__title { font-size: clamp(2.4rem, 4vw + 1rem, 4.4rem); line-height: 1.04; margin: 0 0 16px; }
    .accent-underline { position: relative; display: inline-block; }
    .accent-underline::after { content: ""; position: absolute; left: 0; right: 0; bottom: 4px; height: 10px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); opacity: .25; border-radius: 6px; transform: skewX(-6deg); }
    .hero__lead { font-size: clamp(1.05rem, 1.2vw + .8rem, 1.35rem); color: var(--muted); margin-bottom: 22px; }

    .cta-row { display: flex; flex-wrap: wrap; gap: 12px; }
    .btn { display: inline-flex; align-items: center; gap: 10px; padding: 12px 16px; border-radius: 12px; font-weight: 600; border: 1px solid transparent; cursor: pointer; transition: transform .15s var(--ease), background .25s var(--ease), border-color .25s var(--ease); }
    .btn--primary { background: linear-gradient(90deg, var(--accent), var(--accent-2)); color: #0a0d12; box-shadow: var(--shadow); }
    .btn--primary:hover { transform: translateY(-2px); }
    .btn--ghost { background: transparent; color: var(--text); border-color: var(--accent-mix-1); }
    .btn--ghost:hover { border-color: var(--accent); }

    .hero__card { background: linear-gradient(180deg, rgba(125, 211, 252, 0.05), rgba(167, 139, 250, 0.05)); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); border: var(--line); }
    .stat { display: grid; grid-template-columns: auto 1fr; gap: 10px 14px; align-items: baseline; }
    .stat__num { font-family: "Space Grotesk", Inter, sans-serif; font-size: 1.9rem; color: var(--accent); }
    .stat__lbl { color: var(--muted); }
    .stat__lbl a { color: var(--muted); text-decoration: none; border-bottom: 1px dashed color-mix(in oklab, var(--accent) 35%, transparent); padding-bottom: 1px; }
    .stat__lbl a:hover { color: var(--accent); border-bottom-color: var(--accent); }

    /* =====================
       SECTIONS
       ===================== */
    section { padding: 60px 0; position: relative; }
    .section__hd { display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 18px; }
    .section__title { font-size: clamp(1.6rem, 1.4vw + 1rem, 2.2rem); }

    /* Reveal animation (slightly more fluid) */
    .reveal { opacity: 0; transform: translateY(var(--reveal-distance)) scale(0.995) skewY(0.25deg); filter: blur(var(--reveal-blur)); transform-origin: 50% 60%; transition: opacity var(--reveal-duration) var(--reveal-ease), transform var(--reveal-duration) var(--reveal-ease), filter var(--reveal-duration) var(--reveal-ease); }
    .reveal.is-in { opacity: 1; transform: translateY(0) scale(1) skewY(0deg); filter: blur(0); }
    .flow { opacity: 0; transform: translateY(calc(var(--reveal-distance) + 4px)) scale(0.992) skewY(0.35deg); filter: blur(calc(var(--reveal-blur) + 1px)); transition: opacity calc(var(--reveal-duration) + .05s) var(--reveal-ease), transform calc(var(--reveal-duration) + .1s) var(--reveal-ease), filter calc(var(--reveal-duration) + .05s) var(--reveal-ease); transition-delay: var(--d, 0ms); will-change: transform, opacity, filter; }
    .flow.is-in { opacity: 1; transform: translateY(0) scale(1) skewY(0deg); filter: blur(0); }

    /* =====================
       TIMELINE (Education)
       ===================== */
    .timeline { position: relative; margin-top: 18px; }
    .timeline::before { content: ""; position: absolute; left: 16px; top: 0; bottom: 0; width: 2px; background: var(--accent-mix-1); }
    .tl-item { display: grid; grid-template-columns: 40px 1fr; gap: 16px; padding: 14px 8px; }
    .tl-dot { width: 14px; height: 14px; background: var(--accent); border-radius: 999px; margin-top: 6px; box-shadow: 0 0 0 4px var(--accent-mix-1); }
    .tl-card { background: var(--card); border-radius: 14px; padding: 16px; border: var(--line); box-shadow: var(--shadow); }
    .tl-card h4 { margin: 0 0 6px; }
    .tl-meta { color: var(--muted); font-size: .95rem; }

    /* =====================
       PROJECT GRID
       ===================== */
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 18px; }
    @media (max-width: 980px){ .grid { grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 640px){ .grid { grid-template-columns: 1fr; } }
    .card { background: linear-gradient(180deg, var(--card), var(--card-2)); border-radius: var(--radius); padding: 18px; border: var(--line); box-shadow: var(--shadow); text-align: left; }
    .card h4 { margin: 0 0 8px; }
    .tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
    .tag { padding: 6px 10px; border-radius: 999px; background: var(--accent-mix-1); color: var(--text); border: 1px solid color-mix(in oklab, var(--accent) 35%, transparent); font-size: .85rem; }
    .card .actions { display: flex; gap: 10px; margin-top: 12px; }

    /* =====================
       SKILLS (pill list)
       ===================== */
    .skills { display: flex; flex-wrap: wrap; gap: 10px; }
    .pill { padding: 8px 12px; border-radius: 999px; border: var(--line); background: rgba(255,255,255,0.02); }

    /* =====================
       CONTACT BAR
       ===================== */
    .contact { display: grid; gap: 14px; grid-template-columns: repeat(3, minmax(0,1fr)); }
    @media (max-width: 760px){ .contact { grid-template-columns: 1fr; } }
    .contact a { display: inline-flex; justify-content: center; align-items: center; gap: 10px; border: var(--line); padding: 14px 16px; border-radius: 12px; background: linear-gradient(180deg, var(--card), var(--card-2)); box-shadow: var(--shadow); font-weight: 600; }
    .contact a svg { width: 20px; height: 20px; display: inline-block; fill: currentColor; }

    /* =====================
       PROBABILITY BLOG LAYOUT
       ===================== */
    #prob { display:none; }
    #prob .notes-wrap { display: grid; grid-template-columns: 320px 1fr; gap: 24px; }
    @media (max-width: 980px){ #prob .notes-wrap { grid-template-columns: 1fr; } }
    #prob .toc { position: sticky; top: 90px; align-self: start; background: var(--card); border: var(--line); border-radius: 14px; box-shadow: var(--shadow); padding: 16px; }
    #prob .toc h4 { margin: 0 0 8px; }
    #prob .toc ol { margin: 0; padding-left: 18px; }
    #prob .toc li { margin: 6px 0; }
    #prob .toc a { color: var(--text); opacity: .9; }
    #prob .toc a:hover { opacity: 1; color: var(--accent); text-decoration: underline; }
    #prob .posts { display: grid; gap: 24px; }
    #prob .post { background: var(--card); border: var(--line); box-shadow: var(--shadow); border-radius: 16px; padding: 18px 20px; }
    #prob .post h4 { margin: 0 0 8px; }
    #prob .post .meta { color: var(--muted); font-size: .9rem; margin-bottom: 8px; }
    #prob .lib-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    @media (max-width: 980px){ #prob .lib-grid { grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 640px){ #prob .lib-grid { grid-template-columns: 1fr; } }
    #prob .lib-card { background: var(--card); border: var(--line); border-radius: 14px; padding: 16px; box-shadow: var(--shadow); display:block; }
    #prob .lib-card h4 { margin: 0 0 6px; }
    #prob .lib-card p { margin: 0; color: var(--muted); }

    /* =====================
       FOOTER
       ===================== */
    footer { padding: 60px 0 40px; text-align: center; color: var(--muted); }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) { .reveal, .flow { transition: none !important; transform: none !important; filter: none !important; opacity: 1 !important; } }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="container nav__inner">
      <div class="nav__links">
        <a href="#about">About</a>
        <a href="#education">Education</a>
        <a href="#projects">Projects</a>
        <a href="#contact">Contact</a>
        <a href="#/prob" id="probLink">Probability Blog</a>
        <button class="theme-btn" id="themeToggle" aria-label="Toggle theme">☀️</button>
      </div>
    </div>
  </nav>

  <header class="hero">
    <div class="container hero__grid">
      <div>
        <h1 class="hero__title flow"><span class="accent-underline">Hi, I'm Nicolò</span>.</h1>
        <p class="hero__lead flow">MS in Applied Mathematics @ Columbia University. I work across <strong>Probability Theory</strong>, <strong>Stochastic Dynamical Systems</strong>, and <strong>Probabilistic Models</strong>.
        </p>
        <div class="cta-row flow">
          <a class="btn btn--primary" href="#projects">View Projects</a>
          <a class="btn btn--ghost" href="#contact">Get in Touch</a>
          <a class="btn btn--ghost" href="#" aria-disabled="true" title="Add your CV link">Download CV</a>
        </div>
      </div>
      <aside class="hero__card flow" aria-label="Quick Stats">
        <div class="stat">
          <div class="stat__num">1</div>
          <div class="stat__lbl"><a href="https://www.apam.columbia.edu/programs/applied-mathematics" target="_blank" rel="noopener">MS (Applied Mathematics @ Columbia)</a></div>
          <div class="stat__num">2</div>
          <div class="stat__lbl"><a href="https://corsidilaurea.uniroma1.it/it/course/33593" target="_blank" rel="noopener">BS in Mathematical Sciences for AI @ Sapienza</a></div>
          <div class="stat__num">3</div>
          <div class="stat__lbl"><a href="https://corsi.unibo.it/laurea/ScienzeStatistiche" target="_blank" rel="noopener">BS in Statistical Sciences @ Bologna</a></div>
          <div class="stat__num">∞</div>
          <div class="stat__lbl">Curiosity • Proofs • Experiments</div>
        </div>
      </aside>
    </div>
  </header>

  <main>
    <!-- ABOUT -->
    <section id="about" class="reveal">
      <div class="container">
        <div class="section__hd"><h2 class="section__title">About</h2></div>
        <p class="flow">I’m a mathematician in training with a rigorous background in probability theory, measure theory, and PDEs. I enjoy turning abstract ideas into concrete models and clean, reproducible code. Interests: martingales, stochastic dynamics, and probabilistic number theory.</p>
      </div>
    </section>

    <!-- EDUCATION (timeline) -->
    <section id="education" class="reveal">
      <div class="container">
        <div class="section__hd"><h2 class="section__title">Education</h2></div>
        <div class="timeline">
          <div class="tl-item flow">
            <div class="tl-dot" aria-hidden="true"></div>
            <div class="tl-card">
              <h4>Columbia University — MS Applied Mathematics</h4>
              <div class="tl-meta">2025–2026 · New York, USA</div>
              <p>Analysis & Probability I (PhD), Probabilistic Models & Machine Learning (PhD), Advanced Probability (PhD/MS), Partial Differential Equations (PhD/MS).</p>
            </div>
          </div>
          <div class="tl-item flow">
            <div class="tl-dot" aria-hidden="true"></div>
            <div class="tl-card">
              <h4>Sapienza University — BS in Mathematical Sciences for AI</h4>
              <div class="tl-meta">Final Grade: 110/110 cum laude · Rome, Italy</div>
              <p>Mathematical foundations of AI, optimization, stochastic modeling.</p>
            </div>
          </div>
          <div class="tl-item flow">
            <div class="tl-dot" aria-hidden="true"></div>
            <div class="tl-card">
              <h4>University of Bologna — BS Statistical Sciences</h4>
              <div class="tl-meta">Final Grade: 110/110 cum laude · Bologna, Italy</div>
              <p>Thesis in probabilistic number theory on the Collatz Conjecture.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PROJECTS (grid) -->
    <section id="projects" class="reveal">
      <div class="container">
        <div class="section__hd"><h2 class="section__title">Selected Projects</h2></div>
        <div class="grid">
          <article class="card flow">
            <h4>Probabilistic Collatz</h4>
            <p>Stochastic analogues and heuristics for Collatz; Monte Carlo experiments and limit distributions.</p>
            <div class="tags">
              <span class="tag">Python</span>
              <span class="tag">Probability</span>
              <span class="tag">Monte Carlo</span>
            </div>
            <div class="actions">
              <a class="btn btn--ghost" href="#" aria-disabled="true">Notes</a>
            </div>
          </article>
          <article class="card flow">
            <h4>Chronicles from Deterministic Chaos</h4>
            <p>Poincaré sections, Melnikov method, and bifurcation sketches for a driven pendulum.</p>
            <div class="tags">
              <span class="tag">Dynamical Systems</span>
              <span class="tag">PDEs</span>
            </div>
            <div class="actions">
              <a class="btn btn--ghost" href="#" aria-disabled="true">Slides</a>
            </div>
          </article>
          <article class="card flow">
            <h4>EndParty</h4>
            <p>Event-detection and crowd-flow analytics; probabilistic signals with lightweight models.</p>
            <div class="tags">
              <span class="tag">Data</span>
              <span class="tag">Realtime</span>
            </div>
            <div class="actions">
              <a class="btn btn--ghost" href="#" aria-disabled="true">Case Study</a>
            </div>
          </article>
        </div>
      </div>
    </section>
  </main>

  <!-- PROBABILITY BLOG (client-routed) -->
  <div id="prob" class="reveal">
    <section>
      <div class="container">
        <div class="section__hd"><h2 class="section__title">Probability Blog</h2></div>
        <p class="flow">Approfondimenti rigorosi con prove, esempi e riferimenti. Scegli un argomento oppure usa la tabella dei contenuti a sinistra.</p>
        <div class="lib-grid flow" id="prob-grid"></div>
      </div>
    </section>
    <section>
      <div class="container">
        <div class="notes-wrap">
          <aside class="toc flow">
            <h4>Contents</h4>
            <ol id="prob-toc"></ol>
          </aside>
          <div class="posts" id="prob-posts"></div>
        </div>
      </div>
    </section>
  </div>

  <!-- CONTACT -->
  <section id="contact" class="reveal">
    <div class="container">
      <div class="section__hd"><h2 class="section__title">Contact</h2></div>
      <div class="contact">
        <a class="flow" href="mailto:nb3328@columbia.edu" aria-label="Email">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 2v.01L12 12 4 6.01V6h16ZM4 18V8.236l7.386 5.526a1 1 0 0 0 1.228 0L20 8.236V18H4Z"/></svg>
          Email
        </a>
        <a class="flow" href="https://www.linkedin.com/in/nicolobonacorsi/" target="_blank" rel="noopener" aria-label="LinkedIn">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M20.451 20.451h-3.554v-5.569c0-1.328-.027-3.036-1.85-3.036-1.853 0-2.136 1.447-2.136 2.943v5.662H9.357V9h3.414v1.561h.049c.476-.9 1.637-1.85 3.368-1.85 3.6 0 4.266 2.37 4.266 5.455v6.285zM5.337 7.433a2.062 2.062 0 1 1 0-4.124 2.062 2.062 0 0 1 0 4.124zM7.114 20.451H3.56V9h3.554v11.451zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          LinkedIn
        </a>
        <a class="flow" href="https://github.com/nicobonacorsi" target="_blank" rel="noopener" aria-label="GitHub">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M12 .5a11.5 11.5 0 0 0-3.637 22.417c.575.105.786-.247.786-.55 0-.271-.01-.988-.015-1.94-3.2.696-3.877-1.542-3.877-1.542-.523-1.328-1.278-1.681-1.278-1.681-1.044-.705.08-.691.08-.691 1.154.081 1.762 1.186 1.762 1.186 1.027 1.76 2.694 1.253 3.35.958.105-.738.402-1.253.732-1.541-2.555-.289-5.242-1.277-5.242-5.683 0-1.255.45-2.279 1.186-3.084-.119-.29-.514-1.457.112-3.036 0 0 .967-.31 3.17 1.179a10.99 10.99 0 0 1 2.886-.389c.98.005 1.968.132 2.892.389 2.2-1.489 3.166-1.179 3.166-1.179.628 1.579.233 2.746.115 3.036.74.805 1.185 1.829 1.185 3.084 0 4.417-2.692 5.39-5.257 5.675.414.353.78 1.046.78 2.112 0 1.524-.014 2.754-.014 3.129 0 .306.206.663.793.549A11.502 11.502 0 0 0 12 .5z"/></svg>
          GitHub
        </a>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <p>© <span id="year"></span> Nico Bonacorsi — Built with care. Dark Neon theme.</p>
    </div>
  </footer>

  <script>
    // ===== Theme: still provide a light mode if needed =====
    const themeBtn = document.getElementById('themeToggle');
    const LIGHT_CLASS = 'light';
    const saved = localStorage.getItem('theme');
    if (saved === LIGHT_CLASS) document.body.classList.add(LIGHT_CLASS);
    const setIcon = () => themeBtn.textContent = document.body.classList.contains(LIGHT_CLASS) ? '🌙' : '☀️';
    setIcon();
    themeBtn.addEventListener('click', () => {
      document.body.classList.toggle(LIGHT_CLASS);
      localStorage.setItem('theme', document.body.classList.contains(LIGHT_CLASS) ? LIGHT_CLASS : 'dark');
      setIcon();
    });

    // Light mode overrides (kept minimal)
    const styleLight = document.createElement('style');
    styleLight.textContent = `
      /* =====================
         LIGHT MODE — Bordeaux accents, higher contrast
         ===================== */
      body.light {
        color-scheme: light;
        /* Override CSS variables for light theme */
        --bg: #eceff3;
        --bg-soft: #f4f6fa;
        --card: #ffffff;
        --card-2: #f8f9fb;
        --text: #12151a;
        --muted: #2f3a45;
        --line: 1px solid rgba(10,20,30,0.10);
        --accent: #8a1538;   /* Bordeaux */
        --accent-2: #f2a3b1; /* warm rose for gradients */
        --accent-mix-1: color-mix(in oklab, var(--accent) 26%, transparent);
        --accent-mix-2: color-mix(in oklab, var(--accent-2) 26%, transparent);
        background: var(--bg);
        background-image: none;
        color: var(--text);
      }
      /* Navbar becomes solid with subtle border */
      body.light .nav { background: rgba(255,255,255,.95); border-bottom: 1px solid rgba(10,20,30,.08); }
      body.light .brand__tag, body.light p, body.light .tl-meta { color: var(--muted); }
      /* Cards and contact tiles on light */
      body.light .card, body.light .contact a { background: linear-gradient(180deg, var(--card), var(--card-2)); border: var(--line); }
      /* Hero stat card gets a Bordeaux tint */
      body.light .hero__card { background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 10%, #ffffff), color-mix(in oklab, var(--accent-2) 10%, #ffffff)); border: var(--line); }
      /* Links, buttons, tags pick up Bordeaux */
      body.light a { color: var(--accent); }
      body.light a:hover { color: color-mix(in oklab, var(--accent) 80%, black); }
      body.light .btn--primary { background: linear-gradient(90deg, var(--accent), var(--accent-2)); color: #fff; }
      body.light .btn--ghost { border-color: var(--accent-mix-1); color: var(--text); }
      body.light .btn--ghost:hover { border-color: var(--accent); }
      body.light .tag { background: var(--accent-mix-1); border: 1px solid color-mix(in oklab, var(--accent) 40%, transparent); }
      /* Lists & headings: ensure strong contrast */
      body.light h1, body.light h2, body.light h3, body.light h4 { color: #0e1116; }
      body.light li { color: var(--text); }
      /* Code & pre blocks: readable on light */
      body.light code { background: #f3f5f8; border: 1px solid rgba(10,20,30,0.12); border-radius: 6px; padding: 2px 6px; }
      body.light pre { background: #f3f5f8; border: 1px solid rgba(10,20,30,0.12); border-radius: 10px; padding: 14px; overflow:auto; }
    `;
    document.head.appendChild(styleLight);

    // ===== Section reveal =====
    const secObserver = new IntersectionObserver(entries => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('is-in'); });
    }, { threshold: 0.16 });
    document.querySelectorAll('.reveal').forEach(el => secObserver.observe(el));

    // ===== Fluid stagger reveal =====
    const flowObserver = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (!e.isIntersecting) return;
        const flows = e.target.querySelectorAll('.flow');
        flows.forEach((node, i) => {
          node.style.setProperty('--d', `${i * 90}ms`);
          requestAnimationFrame(() => node.classList.add('is-in'));
        });
        flowObserver.unobserve(e.target);
      });
    }, { threshold: 0.05 });
    document.querySelectorAll('section, header.hero').forEach(sec => flowObserver.observe(sec));
    document.querySelectorAll('.hero .flow').forEach(node => node.classList.add('is-in'));

    // ===== Smooth anchor offset =====
    const offset = 80;
    document.querySelectorAll('.nav__links a[href^="#"]').forEach(link => {
      link.addEventListener('click', (e) => {
        const href = link.getAttribute('href');
        if (href.startsWith('#/')) return; // reserved future routing
        e.preventDefault();
        const target = document.querySelector(href);
        if (!target) return;
        const top = target.getBoundingClientRect().top + window.scrollY - offset;
        window.scrollTo({ top, behavior: 'smooth' });
      });
    });

    // ===== Year in footer =====
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== Simple router for Probability Blog =====
    const heroEl = document.querySelector('header.hero');
    const mainEl = document.querySelector('main');
    const probEl = document.getElementById('prob');
    const probGrid = document.getElementById('prob-grid');
    const probToc = document.getElementById('prob-toc');
    const probPosts = document.getElementById('prob-posts');

    const PROB_DATA = [
      { id:'lln', title:'Law of Large Numbers — weak vs strong', date:'Updated: Oct 30, 2025', tags:'LLN, convergence',
        excerpt:'Kolmogorov SLLN via truncation + Kronecker; weak vs strong assumptions.',
        html:`<p>We compare weak and strong LLN under different moment/independence assumptions, and show how truncation + Kronecker lemma deliver almost-sure convergence in the finite variance case.</p>` },
      { id:'clt', title:'Central Limit Theorem — Lindeberg & Lévy', date:'Updated: Oct 30, 2025', tags:'CLT, distribution',
        excerpt:'From Lyapunov to Lindeberg and Lévy’s continuity theorem.',
        html:`<p>If (X_i) are i.i.d. with mean μ and variance σ²∈(0,∞), then (∑(X_i-μ))/(σ√n) ⇒ N(0,1). Sketch via Lindeberg and Lévy.</p>` },
      { id:'modes', title:'Modes of Convergence — map & pitfalls', date:'Updated: Oct 30, 2025', tags:'a.s., in P, in L^p, in d',
        excerpt:'Implications, counterexamples, Portmanteau tricks.',
        html:`<p>We distinguish a.s., in probability, in L^p, and in distribution; give examples of non-implications and bounded continuous test functions tricks.</p>` },
      { id:'martingale', title:'Optional Sampling — precise hypotheses', date:'Draft', tags:'martingale, stopping',
        excerpt:'Bounded T, UI cases, counterexamples, applications.',
        html:`<p>We collect forms of optional sampling (UI, bounded stopping times, integrability), give counterexamples when hypotheses fail, and show applications.</p>` },
    ];

    function renderProb(selectedId){
      // grid of topics
      if (probGrid){
        probGrid.innerHTML = PROB_DATA.map(p => `
          <a class="lib-card" href="#/prob/${p.id}">
            <h4>${p.title}</h4>
            <p>${p.excerpt}</p>
          </a>
        `).join('');
      }
      // TOC
      if (probToc){
        probToc.innerHTML = PROB_DATA.map((p,i)=>`<li><a href="#/prob/${p.id}">${i+1}. ${p.title}</a></li>`).join('');
      }
      // Posts area
      if (probPosts){
        const toShow = selectedId ? PROB_DATA.filter(p=>p.id===selectedId) : PROB_DATA.slice(0,1);
        probPosts.innerHTML = toShow.map(p => `
          <article id="p-${p.id}" class="post">
            <h4>${p.title}</h4>
            <div class="meta">${p.date} • Tags: ${p.tags}</div>
            ${p.html}
          </article>
        `).join('');
      }
    }

    function show(el){ el && (el.style.display=''); }
    function hide(el){ el && (el.style.display='none'); }

    function route(){
      const hash = location.hash || '';
      const m = hash.match(/^#\/prob(?:\/([^\/]+))?$/);
      if (m){
        const pid = m[1] || null;
        hide(heroEl); hide(mainEl); show(probEl);
        renderProb(pid);
        // scroll to top of blog
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        show(heroEl); show(mainEl); hide(probEl);
      }
    }
    window.addEventListener('hashchange', route);
    document.addEventListener('DOMContentLoaded', route);
  </script>
</body>
</html>





